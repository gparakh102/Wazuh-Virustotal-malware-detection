<h1>Basic Home Lab Running Active Directory</h1>

<h2>Description</h2>
In cybersecurity, early detection of threats is crucial. During this lab, Wazuh and VirusTotal were utilized for real-time malware detection. Recognizing malware early is vital for preventing breaches and data risks. Rather than relying solely on traditional antivirus solutions, integrating VirusTotal with Wazuh SIEM allows scrutiniy of suspicious files effectively, thereby enhancing defenses. This combined approach strengthens the network's ability to respond swiftly to emerging threats.<br/><br />

Special acknowledgments and credits to Mr. Rajneesh Gupta for his invaluable contributions and guidance.<br/><br/>
<br />



<h2>Requirements </h2>

- <b>Virtal Box</b>
- <b>Windows 10/11 VM</b>
- <b>Wazuh OVA File (required at least 8GB RAM and 4 cores)</b>

<h2>Practical lab walk-through:</h2><br/>

<p>
<h2><b>Sections:- </b></h2>
<h3><b>1. Set up Wazuh on Virtual Box</b></h3>
<h3><b>2. Set up VirusTotal account and retrieve API key</b></h3>
<h3><b>3. Integrate Virustotal on Wazuh Manager</b></h3>
<h3><b>4. Setting up Wazuh Agent to detect file changes</b></h3>
<br/><br/><br/>
 
<h3><b>1: Set up Wazuh and Windows 10 VM on Virtual Box</b></h3>
<br/>
Download and install <a href="https://www.virtualbox.org/wiki/Downloads">Virtual Box</a> <br />
<img src="https://i.postimg.cc/pLJQB8xD/1.png" height="50%" width="50%" alt="Steps"/><br /><br />
Download and install <a href="https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/">Windows 10/11 Virtual Edition</a>on Virtual Box
<br />
<img src="https://i.postimg.cc/vHW2p4bm/69-1.png" height="50%" width="50%" alt="Steps"/>
<br />
<br />
Download the <a href="https://documentation.wazuh.com/current/deployment-options/virtual-machine/virtual-machine.html">Wazuh OVA file</a>
<br />
<img src="https://i.postimg.cc/KcpnqFdH/1.png" height="50%" width="50%" alt="Steps"/>
<br />
<br />
Open the OVA file in Virtualbox<br />
<img src="https://i.postimg.cc/Qt33ZRvL/69.png" height="50%" width="50%" alt="Steps"/>
<br /><br />
Now, log in to Wazuh CLI and run <b><i>ifconfig</i></b> to get the IP address.
The default Wazuh CLI credential is <br />
username: wazuh-user<br />
password: wazuh<br />
<img src="https://i.postimg.cc/3JP2h1rj/1.png" height="50%" width="50%" alt="Steps"/>
<br /><br />
On obtaining the IP address, open the browser on the Windows 10 VM and type the URL https://<WAZUH_IP_ADDRESS> (In my case it is "https://192.168.0.152" Clicking on it won't work as the Wazuh VM is not up on my side)<br /><br />
The Wazuh GUI credentials are:-<br />
username: admin<br />
password: admin<br />
<img src="https://i.postimg.cc/wBzJyBm7/2.png" height="50%" width="50%" alt="Steps"/>
<br /><br />
Once logged in, click on <b><i>Add Agent</i></b>, as in image below<br /> 
<img src="https://i.postimg.cc/sXDhm0Kz/3.png" height="50%" width="50%" alt="Steps"/><br /><br />
Next, select the Operating system on which the agent will be installed, and enter the Wazuh Server address as below<br />
<img src="https://i.postimg.cc/wvfsGcbm/4.png" height="50%" width="50%" alt="Steps"/><br /><br />
At the end, a PowerShell script and a command to start the Wazuh service is displayed. Run the script on powershell in the Windows VM and after it is successfully finished running, start the Wazuh agent<br />
<img src="https://i.postimg.cc/JzZZzXtf/5.png" height="50%" width="50%" alt="Steps"/><br />
<img src="https://i.postimg.cc/28qngMY8/6.png" height="50%" width="50%" alt="Steps"/><br /><br />
Finally, back on the Wazuh platform the newly onboarded Windows agent is now visible<br />
<img src="https://i.postimg.cc/g0KhvPV4/7.png" height="50%" width="50%" alt="Steps"/><br /><br /><br />



<h3><b>2. Set up VirusTotal account and retrieve API key</b></h3>


























</p>
<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
